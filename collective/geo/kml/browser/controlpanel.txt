collective.geo.kml controlpanel
===============================

Overview
--------
collective.geo.kml controlpanel provides a graphical user interface to store settings for geo kml properties

Tests
-----
we start the tests with the usual boilerplate
    >>> from Products.Five.testbrowser import Browser
    >>> browser = Browser()
    >>> browser.handleErrors = False
    >>> portal_url = self.portal.absolute_url()
    >>> self.portal.error_log._ignored_exceptions = ()

    >>> from Products.PloneTestCase.setup import portal_owner, default_password
    >>> browser.open(portal_url)


we log in and verify the functionality of collective.geo.kml control panel form;
    >>> browser.getControl(name='__ac_name').value = portal_owner
    >>> browser.getControl(name='__ac_password').value = default_password
    >>> browser.getControl(name='submit').click()
    >>> browser.open('%s/@@geokml-controlpanel' % portal_url)
    >>> browser.getControl(name = 'form.widgets.linewidth').value
    '2.0'

we set 'line width' property to '3.0' and modify 'marker_image', save data
    >>> browser.getControl(name = 'form.widgets.linewidth').value = '3.0'
    >>> browser.getControl(name = 'form.widgets.marker_image').value = 'marker-blue.png'
    >>> browser.getControl(name = 'form.widgets.marker_image_size').value = '1.0'

Check for the display properties select boxes

    >>> browser.getControl(name = 'form.widgets.display_properties.to')
    <ListControl name='form.widgets.display_properties.to' type='select'>
    >>> browser.getControl(name = 'form.widgets.display_properties.from')
    <ListControl name='form.widgets.display_properties.from' type='select'>

    >>> browser.getControl('Apply').click()

and check for expected modifications
    >>> current_linewidth = browser.getControl(name = 'form.widgets.linewidth').value
    >>> current_linewidth
    '3.0'

    >>> current_marker_image = browser.getControl(name = 'form.widgets.marker_image').value
    >>> current_marker_image
    'marker-blue.png'

    >>> current_marker_image_size = browser.getControl(name = 'form.widgets.marker_image_size').value
    >>> current_marker_image_size
    '1.0'

Now, check that these default settings appear on a new content item we create

    >>> geostyles_doc = portal['test-document-geostyles']
    >>> geostyles_doc
    <ATDocument at /plone/test-document-geostyles>

    >>> browser.open(geostyles_doc.absolute_url())

    >>> browser.getLink('Coordinates').click()

Check that our settings from our control panel are the same value here (set as default on the initial form load)

    >>> browser.getControl(name = 'styles0.widgets.linewidth').value == current_linewidth
    True

    >>> browser.getControl(name = 'styles0.widgets.marker_image').value == current_marker_image
    True

    >>> browser.getControl(name = 'styles0.widgets.marker_image_size').value == current_marker_image_size
    True 

